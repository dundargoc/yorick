#!/usr/bin/env fish

if set -q NVIM_LISTEN_ADDRESS
    nvr \
        -c 'Gdiffsplit!' \
        -c 'setlocal bufhidden=delete' \
        --remote-tab-wait \
        $argv

    # Re-enter insert mode after the buffer is closed.
    nvr -c startinsert
else
    /usr/bin/nvim -c 'Gdiffsplit!' $argv
end
